{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar prop_types_1 = require(\"prop-types\");\nvar react_1 = __importStar(require(\"react\"));\nvar uiFunctions_1 = require(\"./uiFunctions\");\nfunction ScrollRenderer(props) {\n  var list = props.list,\n    _a = props.renderItem,\n    renderItem = _a === void 0 ? null : _a,\n    groupSeparator = props.groupSeparator;\n  var _b = (0, react_1.useState)({\n      renderList: [],\n      index: 0\n    }),\n    render = _b[0],\n    setRender = _b[1];\n  var _c = (0, react_1.useState)(false),\n    mounted = _c[0],\n    setMounted = _c[1];\n  var _d = (0, react_1.useState)(-1),\n    setupCount = _d[0],\n    setSetupCount = _d[1];\n  var containerRef = (0, react_1.createRef)();\n  var renderThisItem = (0, uiFunctions_1.handleRenderItem)(renderItem, (0, uiFunctions_1.handleRenderGroupSeparator)(groupSeparator));\n  var updateRenderInfo = function (count) {\n    if (count === void 0) {\n      count = 10;\n    }\n    if (render.index < list.length) {\n      var index = render.index + count;\n      setRender({\n        renderList: list.slice(0, index),\n        index: index\n      });\n    }\n  };\n  var onScroll = function (span) {\n    return function () {\n      requestAnimationFrame(function () {\n        if (span) {\n          var startingPoint = span.parentNode.offsetTop + span.parentNode.offsetHeight;\n          var anchorPos = span.offsetTop - span.parentNode.scrollTop;\n          if (anchorPos <= startingPoint + span.parentNode.offsetHeight * 2) {\n            updateRenderInfo();\n          }\n        }\n      });\n    };\n  };\n  (0, react_1.useEffect)(function () {\n    // when mounted\n    setMounted(true);\n    return function () {\n      // when unmounted\n      setMounted(false);\n    };\n  }, []);\n  (0, react_1.useLayoutEffect)(function () {\n    if (mounted) {\n      // reset list on list change\n      var span_1 = containerRef.current;\n      var pos_1 = span_1.parentNode.scrollTop;\n      var index = Math.max(render.renderList.length, setupCount);\n      setRender({\n        renderList: list.slice(0, index),\n        index: index\n      });\n      requestAnimationFrame(function () {\n        if (span_1 && span_1.parentNode) {\n          span_1.parentNode.scrollTop = pos_1;\n        }\n      });\n    }\n  }, [list]);\n  (0, react_1.useLayoutEffect)(function () {\n    var span = containerRef.current;\n    var handleScroll = onScroll(span);\n    var container = null;\n    if (span) {\n      container = span.parentNode;\n      requestAnimationFrame(function () {\n        // populate double the container height of items\n        if (render.index === 0 || container.scrollHeight <= container.offsetHeight * 2) {\n          updateRenderInfo();\n        } else if (setupCount === -1) {\n          setSetupCount(render.index);\n        }\n      });\n      container.addEventListener(\"scroll\", handleScroll, {\n        passive: true\n      });\n    }\n    return function () {\n      // when unmounted\n      if (span) {\n        container.removeEventListener(\"scroll\", handleScroll, {\n          passive: true\n        });\n      }\n    };\n  }, [render.index, list.length]);\n  return react_1.default.createElement(react_1.default.Fragment, null, render.renderList.map(renderThisItem), react_1.default.createElement(\"span\", {\n    ref: containerRef,\n    style: {\n      visibility: \"hidden\",\n      height: 1\n    },\n    className: \"___scroll-renderer-anchor\"\n  }));\n}\nScrollRenderer.propTypes = {\n  list: (0, prop_types_1.arrayOf)(prop_types_1.any).isRequired,\n  renderItem: prop_types_1.func.isRequired,\n  groupSeparator: (0, prop_types_1.oneOfType)([prop_types_1.node, prop_types_1.func, prop_types_1.element])\n};\nScrollRenderer.defaultProps = {\n  groupSeparator: null\n};\nexports.default = ScrollRenderer;","map":{"version":3,"mappings":"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","names":["ScrollRenderer","props","_a","renderItem","groupSeparator","renderList","index","render","setRender","mounted","setMounted","setupCount","setSetupCount","containerRef","renderThisItem","updateRenderInfo","count","list","length","slice","onScroll","span","requestAnimationFrame","startingPoint","parentNode","offsetTop","offsetHeight","anchorPos","scrollTop","span_1","current","pos_1","Math","max","handleScroll","container","scrollHeight","addEventListener","passive","removeEventListener","react_1","map","ref","style","visibility","height","className","propTypes","prop_types_1","isRequired","defaultProps","exports"],"sources":["../../src/___subComponents/ScrollRenderer.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}